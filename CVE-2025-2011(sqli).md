### SQL Injection trong plugin Depicter Slider & Popup Builder (< 3.6.2)

1 Tổng quan lỗ hổng

CVE-ID: CVE-2025-2011

Loại lỗ hổng: SQL Injection

Phần mềm bị ảnh hưởng:

Plugin WordPress Depicter – Slider & Popup Builder

Phiên bản < 3.6.2

Môi trường: WordPress

Điều kiện khai thác:

Không yêu cầu quyền quản trị (tùy endpoint)

Tấn công thông qua HTTP request

Tác động:

Trích xuất dữ liệu cơ sở dữ liệu

Lộ thông tin tài khoản quản trị

Có thể kết hợp leo thang tấn công (chain attack)

2 Mục tiêu của Lab

Tái hiện chính xác lỗ hổng SQL Injection theo CVE-2025-2011

Phân tích nguyên nhân gốc rễ trong mã plugin

Thực hiện khai thác thủ công và tự động

Chứng minh tác động bằng PoC thực tế

3 Build Lab – Thiết lập môi trường thử nghiệm

Khởi động docker desktop

<img width="1333" height="392" alt="image" src="https://github.com/user-attachments/assets/75151cfb-869d-490b-9b4a-addb1be368a3" />

Khởi động môi trường bằng lệnh: docker-compose up -d

<img width="454" height="215" alt="image" src="https://github.com/user-attachments/assets/99d8c64a-ed56-4677-9a57-42abff073dd0" />

Cài đặt WordPress, truy cập: http://localhost:5555 để thực hiện:

Chọn ngôn ngữ

<img width="1120" height="623" alt="image" src="https://github.com/user-attachments/assets/d960e0ce-d0e4-46b8-971b-729633944da6" />

Thiết lập tiêu đề website

Tạo tài khoản quản trị viên

Hoàn tất cài đặt

<img width="577" height="428" alt="image" src="https://github.com/user-attachments/assets/7e7cd167-e584-4dec-bcd3-3c7725e848dc" />

Cài đặt plugin dễ bị tổn thương trong wordpress

B1. Chạy lệnh: docker exec -it cve-2025-2011-main-wordpress-1 bash

<img width="627" height="44" alt="image" src="https://github.com/user-attachments/assets/cecc8e85-74a4-4110-8deb-e52751f2bb95" />

B2. Cài WP-CLI

`curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar`

`chmod +x wp-cli.phar`

`mv wp-cli.phar /usr/local/bin/wp`

<img width="828" height="697" alt="image" src="https://github.com/user-attachments/assets/580d0251-1f0a-4afe-89d3-8e9c449fbe6c" />


`chmod +x install-plugin.sh`

`./install-plugin.sh`


Script thực hiện:

Cài WP-CLI trong container

Tải và cài Depicter v3.6.1

Kích hoạt plugin

Cài thư viện Python cần thiết
